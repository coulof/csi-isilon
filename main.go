package main

/*
 Copyright (c) 2019 Dell Inc, or its subsidiaries.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
//go:generate go generate ./core

import (
	"context"
	"os"

	"github.com/dell/csi-isilon/common/constants"
	"github.com/dell/csi-isilon/provider"
	"github.com/rexray/gocsi"
)

// main is ignored when this package is built as a go plug-in
func main() {
    pluginName := os.Getenv("X_CSI_ISILON_PLUGIN_NAME")
	if len(pluginName) == 0 {
		pluginName = constants.PluginName
    }

	gocsi.Run(
		context.Background(),
        pluginName,
		"An Isilon Container Storage Interface (CSI) Plugin",
		usage,
		provider.New())
}

const usage = `    X_CSI_ISILON_PLUGIN_NAME
        Specifies the name of the provider name (default: csi-isilon.dellemc.com)

    X_CSI_ISILON_ENDPOINT
        Specifies the HTTPS endpoint for the Isilon REST API server. This parameter is
        required when running the Controller service.

        The default value is empty.
    
    X_CSI_ISILON_PORT
        Specifies the HTTPS port number for the Isilon REST API server.

        The default value is 8080.

    X_CSI_ISILON_USER
        Specifies the user name when authenticating to the Isilon REST API server.

        The default value is admin.

    X_CSI_ISILON_PASSWORD
        Specifies the password of the user defined by X_CSI_ISILON_USER to use
        when authenticating to the Isilon REST API server. This parameter is required
        when running the Controller service.

        The default value is empty.

    X_CSI_ISILON_INSECURE
        Specifies that the ISILON Gateway's hostname and certificate chain
	should not be verified.

        The default value is false.

    X_CSI_ISILON_SYSTEMNAME
        Specifies the name of the Isilon system to interact with.

        The default value is default.
`
